<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/assets/favicon.png"> <title>Software</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/">Paul Tiede</a></h1> <p class=lead >Ph.D. candidate Astrophysics with a side of Statistics</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/research/">Research</a> <a class="sidebar-nav-item " href="/publications/">Publications</a> <a class="sidebar-nav-item active" href="/software/">Software</a> <a class="sidebar-nav-item " href="/cv/">CV</a> </nav> <p>&copy; Paul Tiede.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=software ><a href="#software">Software</a></h1> <p>I have experience with C&#43;&#43; and Python although my main programming language currently is Julia. Julia is a recent language that has performance comparable to optimized C code, but with friendly syntax and a abstract type system that makes it easy to construct generic code. </p> <div class=franklin-toc ><ol><li><a href="#themis">Themis</a><li><a href="#vida">VIDA</a></ol></div> <h2 id=themis ><a href="#themis">Themis</a></h2> <p>Themis is the Bayesian inference package written in C&#43;&#43; that is used for analyzing data from the Event Horizon Telescope. I am one of the core developers of Themis having written numerous models and most of the samplers.</p> <p>Themis has been used for many of the biggest EHT results. Many of the quantitative results from the first EHT results on M 87 where due to Themis. One example is the Mass of M 87. </p> <h2 id=vida ><a href="#vida">VIDA</a></h2> <p>VIDA is a tool for feature extraction from image reconstruction of EHT data. This is needed because the current imaging techniques are extremely flexible. While this flexibility is a great feature to have it means that extracting important features &#40;e.g. the diameter of the ring&#41; is difficult. To help automate feature extraction I developed a tools called <em>Variational Image Domain Analysis</em> or VIDA. VIDA works by approximating the image with parameterized models or <strong>filters</strong> ,<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">f_\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, such as Gaussians, ring, disks, etc. and then finds the optimal parameters. For optimality we take inspiration from variational inference and use probability divergences as our objective function. </p> <p>Currently VIDA has two divergences implemented:</p> <ul> <li><p><a href="https://en.wikipedia.org/wiki/Bhattacharyya_distance">Bhattacharyya divergence</a></p> </ul> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>h</mi><mo stretchy=false >(</mo><mi>p</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi>q</mi><mo stretchy=false >)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo>∫</mo><msqrt><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mi>q</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow></msqrt><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex"> Bh(p||q) = -\log \int \sqrt{p(x)q(x)}dx </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">h</span><span class=mopen >(</span><span class="mord mathdefault">p</span><span class=mord >∣</span><span class=mord >∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.22225em;vertical-align:-0.86225em;"></span><span class=mord >−</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.983875em;"><span class=svg-align  style="top:-3.2em;"><span class=pstrut  style="height:3.2em;"></span><span class=mord  style="padding-left:1em;"><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span><span style="top:-2.9438750000000002em;"><span class=pstrut  style="height:3.2em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.25612499999999994em;"><span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">x</span></span></span></span></span> <ul> <li><p><a href="https://en.wikipedia.org/wiki/Kullback&#37;E2&#37;80&#37;93Leibler_divergence">Kullback Leibler</a> divergence</p> </ul> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>L</mi><mo stretchy=false >(</mo><mi>p</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >∣</mi><mi>q</mi><mo stretchy=false >)</mo><mo>=</mo><mo>∫</mo><mi>p</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=true >(</mo><mfrac><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mrow><mi>q</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow></mfrac><mo fence=true >)</mo></mrow><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> KL(p||q) = \int p(x)\log\left(\frac{p(x)}{q(x)}\right). </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault">L</span><span class=mopen >(</span><span class="mord mathdefault">p</span><span class=mord >∣</span><span class=mord >∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span></span></span></span></span> <p>In my experiments I have found that the Bhattacharyya divergence is easier to optimize than the KL divergence.</p> <p>More to come...</p> <h3>Example script</h3> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> VIDA
<span class=hljs-keyword >using</span> Plots
<span class=hljs-comment ># Lets create a filter or approximate image</span>
θ = GaussianRing(r0 = <span class=hljs-number >20.0</span>, 
                 σ = <span class=hljs-number >5.0</span>,
                 x0= <span class=hljs-number >5.0</span>,
                 y0 = <span class=hljs-number >6.0</span>)

<span class=hljs-comment ># We can easily plot this using the Plots.jl package</span>
plot(θ, title=<span class=hljs-string >&quot;Example filter&quot;</span>)

<span class=hljs-comment ># Let&#x27;s now make a sample image with some random noise</span>
img = VIDA.make_ehtimage(θ, <span class=hljs-number >64</span>, [-<span class=hljs-number >60.0</span>,<span class=hljs-number >60.0</span>],[-<span class=hljs-number >60.0</span>,<span class=hljs-number >60.0</span>])
img.img .*=  exp.(randn(<span class=hljs-number >64</span>,<span class=hljs-number >64</span>)*<span class=hljs-number >0.2</span>)

<span class=hljs-comment ># Plotting the image gives</span>
plot(img, title=<span class=hljs-string >&quot;Example filter with noise&quot;</span>)

<span class=hljs-comment ># Now let&#x27;s try to extract the ring parameters</span>
<span class=hljs-comment ># First constuct the divergence from the img</span>
bh = Bhattacharyya(img)

<span class=hljs-comment ># Construct the search bounds</span>
θlower = GaussianRing(r0=<span class=hljs-number >0.1</span>,
                      σ = <span class=hljs-number >0.01</span>,
                      x0=-<span class=hljs-number >60.0</span>,
                      y0=-<span class=hljs-number >60.0</span>)
θupper = GaussianRing(r0=<span class=hljs-number >40</span>,
                      σ = <span class=hljs-number >20</span>,
                      x0=<span class=hljs-number >60.0</span>,
                      y0=<span class=hljs-number >60.0</span>)

<span class=hljs-comment ># Now find the optimal filter and plot it</span>
θopt,_ = bbextract(bh, θ, θlower, θupper)
a = triptic(img, θopt)
title!(a[<span class=hljs-number >1</span>], <span class=hljs-string >&quot;Image&quot;</span>)
title!(a[<span class=hljs-number >2</span>], <span class=hljs-string >&quot;Optimal Filter&quot;</span>)
title!(a[<span class=hljs-number >3</span>], <span class=hljs-string >&quot;Chords&quot;</span>)</code></pre> <p><p><span style="color:red;">// Image matching '/assets/software/code/img' not found. //</span></p> <p><span style="color:red;">// Image matching '/assets/software/code/img2' not found. //</span></p> <p><span style="color:red;">// Image matching '/assets/software/code/triptic' not found. //</span></p></p> <div class=page-foot > <div class=copyright > &copy; Paul Tiede. Last modified: October 16, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div>